function PicoTagEditor(t,e,i){if(["checkbox","radio","hidden","file"].includes(t.getAttribute("type")))return;e=e||{},this.settings={debug:!1,width:void 0,height:void 0,minWidth:void 0,maxHeight:void 0,trimInput:!1,...e},this.initialValue=[],this.containerElement=null,this.name="",this.mouseEnter=!1,this.inputElement=null,this.timeout=null,this.values=[],this.placeholder="",this.focus=!1;let n=this;this.init=function(t){let e=document.createElement("div");e.classList.add("pico-tag-editor"),e.setAttribute("data-focus","false");let i=t.getAttribute("data-initial-value")||"[]",n=t.cloneNode(!0),s=document.createElement("div");s.classList.add("tags-container"),s.style.display="none",["width","height","maxHeight","minWidth"].forEach(t=>{this.settings[t]&&(s.style[t]=this.isNumber(this.settings[t])?`${this.settings[t]}px`:this.settings[t])}),e.appendChild(n),e.appendChild(s),t.replaceWith(e),this.containerElement=e,this.inputElement=n,this.name=n.getAttribute("name")||"",this.name.includes("[")||(this.name+="[]"),n.classList.contains("pico-tag-edit")||n.classList.add("pico-tag-edit"),n.removeAttribute("name"),this.placeholder=n.getAttribute("placeholder")||"",""==i&&(i="[]");try{this.initialValue=JSON.parse(i)}catch(a){}},this.setInitialValue=function(){if(this.initialValue.length>0)for(let t of this.initialValue)this.addTag(t)},this.isNumber=function(t){return/^-?\d+(\.\d+)?$/.test(t)},this.addEvents=function(){let t=this.containerElement.querySelector(".pico-tag-edit");t&&(t.addEventListener("keypress",t=>{"Enter"===t.key&&(t.preventDefault(),t.target.value.trim()&&(n.addTag(n.settings.trimInput?t.target.value.trim():t.target.value,!0),t.target.value=""))}),t.addEventListener("focus",()=>{n.focus=!0,n.containerElement.setAttribute("data-focus","true")}),t.addEventListener("blur",()=>{n.focus=!1,n.containerElement.setAttribute("data-focus",n.settings.debug||n.mouseEnter?"true":"false")}),["mouseenter","mouseleave"].forEach(t=>{this.containerElement.addEventListener(t,()=>{n.mouseEnter="mouseenter"===t,n.timeout&&clearTimeout(n.timeout),n.mouseEnter||n.focus||n.settings.debug||n.waitingForHide(1500)})}))},this.waitingForHide=function(t){this.timeout=setTimeout(()=>n.containerElement.setAttribute("data-focus","false"),t)},this.addTag=function(t,e){let i=this.containerElement.querySelector(".tags-container"),s=document.createElement("div");s.classList.add("pico-tag"),s.textContent=t;let a=document.createElement("input");a.type="hidden",a.name=this.name,a.value=t,s.appendChild(a);let l=document.createElement("span");l.innerHTML="&times;",l.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),i.removeChild(s),n.containerElement.querySelector(".pico-tag-edit").focus(),n.updateValues(),i.querySelector(".pico-tag")||(i.style.display="none")}),s.appendChild(l),i.appendChild(s),i.style.display="",this.updateValues(),e&&(this.timeout&&clearTimeout(this.timeout),this.containerElement.setAttribute("data-focus","true"))},this.updateValues=function(){this.values=[];let t=this.containerElement.querySelectorAll('.pico-tag input[type="hidden"]');if(void 0!==t)for(let e of t)this.values.push(e.value);this.containerElement.querySelector(".pico-tag-edit").setAttribute("placeholder",this.values.length>0?`[${this.values.join(", ")}]`:this.placeholder)},this.init(t),i&&i(this.inputElement,this.containerElement,this),this.addEvents(),this.setInitialValue()}